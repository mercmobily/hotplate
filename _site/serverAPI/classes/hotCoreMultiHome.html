<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>hotCoreMultiHome - Hotplate&#x27;s API</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.8.0pr2/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <script src="http://yui.yahooapis.com/combo?3.8.0pr2/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            <h1><a href="../index.html"><img src="../assets/css/logo.png" width="117" height="52">Hotplate&#x27;s API: hotCoreMultiHome</a></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.2.1</em>
        </div>
    </div>
    <div class="yui3-g">

        <div id="sidebar" class="yui3-u">
            <div id="modules" class="sidebox">
                <div class="hd">
                    <h2 class="no-toc">Modules</h2>
                </div>
                <div class="bd">
                    <ul>
                            <li><a href="../modules/hotCoreAuth.html">hotCoreAuth</a>
                            </li>
                            <li><a href="../modules/hotCoreClientFiles.html">hotCoreClientFiles</a>
                            </li>
                            <li><a href="../modules/hotCoreMultiHome.html">hotCoreMultiHome</a>
                            </li>
                            <li><a href="../modules/hotCoreTransport.html">hotCoreTransport</a>
                            </li>
                    </ul>
                </div>
            </div>
            
            <div id="classes" class="sidebox">
                <div class="hd">
                    <h2 class="no-toc">Classes</h2>
                </div>
                <div class="bd">
                    <ul>
                            <li><a href="../classes/hotCoreAuth.facebook.html">hotCoreAuth.facebook</a></li>
                            <li><a href="../classes/hotCoreAuth.hotCoreAuth.html">hotCoreAuth.hotCoreAuth</a></li>
                            <li><a href="../classes/hotCoreAuth.local.html">hotCoreAuth.local</a></li>
                            <li><a href="../classes/hotCoreClientFiles.html">hotCoreClientFiles</a></li>
                            <li><a href="../classes/hotCoreMultiHome.html">hotCoreMultiHome</a></li>
                            <li><a href="../classes/hotCoreTransport.html">hotCoreTransport</a></li>
                    </ul>
                </div>
            </div>
            
            
            
            
            
            <div id="fileTree" class="sidebox">
                <div class="hd">
                    <h2 class="no-toc">Files</h2>
                </div>
                <div class="bd">
                    <ul><li>hotplate/<ul><li>node_modules/<ul><li>hotCoreAuth/<ul><li>lib/<ul><li>auth/<ul><li><a href="../files/hotplate_node_modules_hotCoreAuth_lib_auth_facebook.js.html">facebook.js</a></li><li><a href="../files/hotplate_node_modules_hotCoreAuth_lib_auth_local.js.html">local.js</a></li></ul></li><li><a href="../files/hotplate_node_modules_hotCoreAuth_lib_hotCoreAuth.js.html">hotCoreAuth.js</a></li></ul></li></ul></li><li>hotCoreClientFiles/<ul><li>lib/<ul><li><a href="../files/hotplate_node_modules_hotCoreClientFiles_lib_hotCoreClientFiles.js.html">hotCoreClientFiles.js</a></li></ul></li></ul></li><li>hotCoreMultiHome/<ul><li>lib/<ul><li><a href="../files/hotplate_node_modules_hotCoreMultiHome_lib_hotCoreMultiHome.js.html">hotCoreMultiHome.js</a></li></ul></li></ul></li><li>hotCorePage/<ul><li>lib/<ul><li><a href="../files/hotplate_node_modules_hotCorePage_lib_Vars.js.html">Vars.js</a></li></ul></li></ul></li><li>hotCoreTransport/<ul><li>lib/<ul><li><a href="../files/hotplate_node_modules_hotCoreTransport_lib_hotCoreTransport.js.html">hotCoreTransport.js</a></li></ul></li></ul></li></ul></li></ul></li></ul>
                </div>
            </div>
            
        </div>

        <div id="main" class="yui3-u">
            <div class="content"><h4>Class hotCoreMultiHome</h4>
<span class="foundat">Class defined in: <a href="../files/hotplate_node_modules_hotCoreMultiHome_lib_hotCoreMultiHome.js.html#l3"><code>hotplate&#x2F;node_modules&#x2F;hotCoreMultiHome&#x2F;lib&#x2F;hotCoreMultiHome.js:3</code></a></span>
<div class="intro"><p>Provides multi-home abilities to Hotplate</p>
<p>WARNING: THIS INFORMATION IS COMPLETELY WRONG AND OUT OF DATE</p>
<p>This module's aim is to make sure Hotplate has full multi-home abilities. The module itself:</p>
<ul>
<li>Defines all of the relevant stores ( <code>workspaces</code>, <code>workspacesUsers</code>, <code>usersWorkspaces</code>)</li>
<li>Places important variables on the rendered page ( <code>vars.hotCoreMultiHome.enabled</code> and <code>.multiHomeURL</code>)</li>
<li>Places the crucial <code>vars.hotCoreMultiHome.workspaceId</code> variable on the rendered page</li>
</ul>
<p>However, given the nature of this module, there are <em>several</em> other modules in Hotplate that interact with it.</p>
<h2>SUMMARY: modules that deal with multihome environments:</h2>
<ul>
<li>
<p>hotCoreJsonRestStores -- it will broadcast comet messages only to workspace users</p>
</li>
<li>
<p>hotCoreStoreConfig -- if the url has <code>:workspaceId</code>, it will set config stores' records in the page for that workspace</p>
</li>
<li>
<p>hotDojoGlobals -- will set global variable workspaceId if it's set within the page</p>
</li>
<li>
<p>hotDojoStoreConfig -- will call <code>stores()</code> passing <code>userId</code> and <code>workspaceId</code> in resolution hash, allowing easy workspace-bound setting lists</p>
</li>
<li>
<p>hotDojoAppContainer -- fully multi-home aware, will hook to correct URL and, if <code>:workspaceId</code> is in the URL, it will check that it exists.</p>
</li>
<li>
<p>hotDojoAuth -- fully multi-home aware, providing a pick mechanism etc. Gets the workspace URL from <code>vars.hotCoreMultiHome.multiHomeURL</code></p>
</li>
<li>
<p>hotDojoComet -- will add header <code>X-hotplate-workspaceId</code> to tab messages requests</p>
</li>
<li>
<p>hotCoreComet -- will use <code>X-hotplate-workspaceId</code> to return updated config records for the expired workspace</p>
</li>
</ul>
<p>A more detailed explanation of what each module does, in terms of interaction with hotCoreMultiHome, follows. Note that any interaction happens on the basis that <code>hotCoreMultiHome</code> is enabled.</p>
<h2>hotCoreJsonRestStores</h2>
<ul>
<li>./node_modules/hotCoreJsonRestStores/lib/hotCoreJsonRestStores.js</li>
</ul>
<p>When broadcasting changes to stores via the hook <code>cometBroadcast</code>, it will change its behavious depending on multi-home being enabled or not.</p>
<p>If multiHome is enabled, checks if the record has a workspaceId field -- in which case, it will only broadcast the message to users in that workspaceId (it will do so by passing a <code>makeTabIdHash()</code> function to the <code>cometBroadcast</code> hook)</p>
<h2>hotCoreStoreConfig</h2>
<ul>
<li>./node_modules/hotCoreStoreConfig/lib/hotCoreStoreConfig.js</li>
</ul>
<p>Implements <code>pageElementsPerPage</code> that passes <code>params.workspaceId</code> to <code>getConfig()</code> -- which means that if the URL has the <code>workspaceId</code> parameter, it will add a variable with the workspace's configuration to the page. It also passes <code>session.userId</code> to <code>getConfig()</code>, so if the user is logged in, it will return that user's config too.</p>
<p>NOTE: <code>getConfig()</code> is implemented here. Signature: <code>function( workspaceId, userId, cb )</code>. It basically will return all configs with <code>workspaceId</code> and/or <code>userId</code> set in their <code>store.configStore</code> property</p>
<h2>hotDojoGlobals</h2>
<ul>
<li>./node_modules/hotDojoGlobals/client/globals.js</li>
</ul>
<p>Sets the global variable <code>workspaceId</code> based on <code>vars.hotCoreMultiHome.workspaceId</code> (Unrelated: it also sets <code>userId</code> based in <code>vars.hotCoreAuth.userId</code>)</p>
<h2>hotDojoStoreConfig</h2>
<ul>
<li>./node_modules/hotDojoStoreConfig/client/ConfigVars.js</li>
</ul>
<p>Config variables are bound to &quot;nothing&quot; (system-wide settings), to a user (user-wide settings), to a workspace (workspace-wide settings) or both (user-specific settings for a specific workspace). That's why ConfigVars will call <code>stores()</code> passing <code>:userId</code> and :<code>workspaceId</code> in resolution hash.</p>
<p>Note that <code>:workspaceId</code> and <code>userId</code> are the ONLY parameters allowed in a config store URL.</p>
<h2>hotDojoAppContainer</h2>
<ul>
<li>./node_modules/hotDojoAppContainer/lib/hotDojoAppContainer.js</li>
</ul>
<p>In terms of URLs, it will attach to <code>hotCoreMultiHome.multiHomeURL</code> or <code>hotCoreAuth.appU R L</code> depending on multi-home being enabled or not. Also, IF <code>:workspaceId</code> is in the URL as a parameter, it will check that the workspace actually exists or it will return an error.</p>
<h2>hotDojoAuth</h2>
<ul>
<li>./node_modules/hotDojoAuth/lib/hotDojoAuth.js</li>
</ul>
<p>The pagePick callback is there just for multi-home environments, picking the workspace</p>
<ul>
<li>./node_modules/hotDojoAuth/client/NewWorkspace.js</li>
</ul>
<p>After adding a new workspace, it will redirect to it thanks to <code>vars.hotCoreMultiHome.multiHomeURL</code> (replacing <code>:workspaceId</code> with the id of the record that was just created)</p>
<ul>
<li>./node_modules/hotDojoAuth/client/Pick.js</li>
</ul>
<p>After picking a workspace, it will redirect to it thanks to <code>vars.hotCoreMultiHome.multiHomeURL</code> as above</p>
<ul>
<li>./node_modules/hotDojoStoreConfig/client/ConfigVars.js</li>
</ul>
<h2>hotDojoComet</h2>
<ul>
<li>./node_modules/hotDojoComet/client/messages.js</li>
</ul>
<p>It adds a header <code>X-hotplate-workspaceId</code> to tabId requests. This is ESSENTIAL so that hotCoreComet knows which workspaceId the tab belongs to. Yes, IT NEEDS to know it: if the tab is not found or it's expired, hotCoreComet will return only one message, <code>resetStores</code>, which will INCLUDE all configuration records for that user and workspace (in order to save GETs and implement error management app-side).</p>
<h2>hotCoreComet</h2>
<ul>
<li>./node_modules/hotCoreComet/lib/hotCoreComet.js</li>
</ul>
<p>Uses the header <code>X-hotplate-workspaceId</code> to return the config stores' records for that <code>workspaceId</code> in case the tab is expired or not there</p>
</div>


<div id="classdocs">
    <ul>
    </ul>
    <div>
    </div>
</div>
</div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/js/tabs.js"></script>
</body>
</html>
